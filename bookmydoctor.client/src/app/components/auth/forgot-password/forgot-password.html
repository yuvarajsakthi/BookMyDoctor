<div class="forgot-password-container">
  <div class="forgot-password-card">
    <div class="forgot-password-header">
      <h2>Reset Password</h2>
      <p>{{getStepDescription()}}</p>
    </div>
    
    <!-- Step 1: Enter Email -->
    <form *ngIf="currentStep === 0" [formGroup]="emailForm" (ngSubmit)="sendOtp()" class="forgot-password-form">
      <div class="form-group">
        <label for="email">Email Address</label>
        <input 
          id="email" 
          type="email" 
          formControlName="email" 
          placeholder="Enter your email"
          [class.error]="emailForm.get('email')?.invalid && emailForm.get('email')?.touched">
        <div class="error-message" *ngIf="emailForm.get('email')?.hasError('required') && emailForm.get('email')?.touched">
          Email is required
        </div>
        <div class="error-message" *ngIf="emailForm.get('email')?.hasError('pattern') && emailForm.get('email')?.touched">
          Email must be a valid Gmail address (@gmail.com)
        </div>
      </div>
      
      <button type="submit" class="forgot-password-btn" [disabled]="!emailForm.valid || isLoading">
        {{isLoading ? 'Sending OTP...' : 'Send OTP'}}
      </button>
    </form>

    <!-- Step 2: Verify OTP -->
    <form *ngIf="currentStep === 1" [formGroup]="otpForm" (ngSubmit)="verifyOtp()" class="forgot-password-form">
      <div class="form-group">
        <label for="otp">OTP Code</label>
        <input 
          id="otp" 
          type="text" 
          formControlName="otp" 
          placeholder="Enter 6-digit OTP" 
          maxlength="6"
          [class.error]="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched">
        <div class="error-message" *ngIf="otpForm.get('otp')?.hasError('required') && otpForm.get('otp')?.touched">
          OTP is required
        </div>
        <div class="error-message" *ngIf="otpForm.get('otp')?.hasError('pattern') && otpForm.get('otp')?.touched">
          Enter a valid 6-digit OTP
        </div>
      </div>
      
      <button type="submit" class="forgot-password-btn" [disabled]="!otpForm.valid || isLoading">
        {{isLoading ? 'Verifying...' : 'Verify OTP'}}
      </button>
    </form>

    <!-- Step 3: Reset Password -->
    <form *ngIf="currentStep === 2" [formGroup]="resetForm" (ngSubmit)="resetPassword()" class="forgot-password-form">
      <div class="form-group">
        <label for="newPassword">New Password</label>
        <input 
          id="newPassword" 
          type="password" 
          formControlName="newPassword" 
          placeholder="Enter new password"
          [class.error]="resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched">
        <div class="error-message" *ngIf="resetForm.get('newPassword')?.hasError('required') && resetForm.get('newPassword')?.touched">
          Password is required
        </div>
        <div class="error-message" *ngIf="resetForm.get('newPassword')?.hasError('minlength') && resetForm.get('newPassword')?.touched">
          Password must be at least 8 characters
        </div>
        <div class="error-message" *ngIf="resetForm.get('newPassword')?.hasError('pattern') && resetForm.get('newPassword')?.touched">
          Password must contain uppercase, lowercase, number and special character
        </div>
      </div>
      
      <button type="submit" class="forgot-password-btn" [disabled]="!resetForm.valid || isLoading">
        {{isLoading ? 'Resetting...' : 'Reset Password'}}
      </button>
    </form>
    
    <div class="forgot-password-footer">
      <a routerLink="/auth/login">Back to Login</a>
    </div>
  </div>
</div>